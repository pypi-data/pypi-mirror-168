"use strict";(self.webpackChunkoira_prototype=self.webpackChunkoira_prototype||[]).push([[6108,7236],{26108:function(t,e,a){a.r(e),a.d(e,{factory:function(){return u},init:function(){return s}});var n=a(37236),i=a(74715),r=a(26798),c=a(76922),o=a(52896);let p;function s({app:t,button:e}){e.addEventListener("pat-modal-ready",(()=>function({app:t}){const e=document.querySelector(t.options.imagePanel);if(!e)return void i.ZP.warn("No image panel found.");(0,n.focus_handler)(e);const a=()=>{const a=e.querySelector("[name=tiptap-src]"),n=e.querySelector("[name=tiptap-alt]"),i=e.querySelector("[name=tiptap-title]"),r=e.querySelector("[name=tiptap-caption]"),c=e.querySelector(".tiptap-confirm, [name=tiptap-confirm]"),p=a=>{const c=e.querySelector("[name=tiptap-src][type=radio]:checked,\n                         [name=tiptap-src][type=checkbox]:checked,\n                         [name=tiptap-src][type=option]:checked,\n                         [name=tiptap-src][type=hidden],\n                         [name=tiptap-src][type=text]"),o=t.editor.chain();o.insertContent({type:"figure",content:[{type:"image-figure",attrs:{src:c.value,...n?.value&&{alt:n?.value},...i?.value&&{title:i?.value}}},...r?.value?[{type:"figcaption",content:[{type:"text",text:r.value}]}]:[]]}),!0===a&&o.focus(),o.run()};c?o.Z.add_event_listener(c,"click","tiptap_image_confirm",(()=>p(!0))):(o.Z.add_event_listener(a,"change","tiptap_image_src",p),o.Z.add_event_listener(n,"change","tiptap_image_alt",p),o.Z.add_event_listener(i,"change","tiptap_image_title",p),o.Z.add_event_listener(r,"change","tiptap_image_caption",p))};a(),p&&p.disconnect(),p=new MutationObserver(a),p.observe(e,{childList:!0,subtree:!0,attributes:!1,characterData:!1})}({app:t})))}const u=()=>r.Node.create({name:"image-figure",addOptions:()=>({HTMLAttributes:{}}),addAttributes:()=>({src:{default:null},alt:{default:null},title:{default:null}}),group:"block",inline:!1,allowGapCursor:!1,atom:!0,draggable:!1,isolating:!0,selectable:!1,parseHTML:()=>[{tag:"img",getAttrs:t=>null!==t.closest("figure")&&null}],renderHTML({HTMLAttributes:t}){return["img",(0,r.mergeAttributes)(this.options.HTMLAttributes,t)]},addProseMirrorPlugins:()=>[new c.Sy({props:{handleDOMEvents:{dragstart:(t,e)=>(e.preventDefault(),!1)}}})]})},37236:function(t,e,a){a.r(e),a.d(e,{TARGETS:function(){return r},focus_handler:function(){return c}});var n=a(52896),i=a(19513);const r=[];function c(t){t.setAttribute("tabindex","-1"),n.Z.add_event_listener(t,"focus","tiptap-focusin",(async()=>{i.Z.timeout(1),r.map((t=>t?.classList.add("tiptap-focus")))}),!0),n.Z.add_event_listener(t,"blur","tiptap-focusout",(()=>{r.map((t=>t?.classList.remove("tiptap-focus")))}),!0)}}}]);
//# sourceMappingURL=6108.0d4495bfb029b1dcab19.min.js.map