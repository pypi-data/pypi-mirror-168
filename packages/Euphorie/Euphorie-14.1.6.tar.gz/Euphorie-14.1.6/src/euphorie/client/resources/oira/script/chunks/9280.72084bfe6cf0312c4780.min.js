"use strict";(self.webpackChunkoira_prototype=self.webpackChunkoira_prototype||[]).push([[9280,7236],{99280:function(t,e,r){r.r(e),r.d(e,{factory:function(){return p},init:function(){return u}});var n=r(37236),a=r(74715),o=r(26798),i=r(76922),s=r(52896);let c;function u({app:t,button:e}){e.addEventListener("pat-modal-ready",(()=>function({app:t}){const e=document.querySelector(t.options.embedPanel);if(!e)return void a.ZP.warn("No embed panel found.");(0,n.focus_handler)(e);const r=()=>{const r=e.querySelector("[name=tiptap-src]"),n=e.querySelector("[name=tiptap-title]"),a=e.querySelector("[name=tiptap-caption]"),o=e.querySelector(".tiptap-confirm, [name=tiptap-confirm]"),i=e=>{const o=t.editor.chain();o.insertContent({type:"figure",content:[{type:"embed",attrs:{src:r.value,...n?.value&&{title:n?.value}}},...a?.value?[{type:"figcaption",content:[{type:"text",text:a.value}]}]:[]]}),!0===e&&o.focus(),o.run()};o?s.Z.add_event_listener(o,"click","tiptap_embed_confirm",(()=>i(!0))):(s.Z.add_event_listener(r,"change","tiptap_embed_src",i),s.Z.add_event_listener(n,"change","tiptap_embed_title",i),s.Z.add_event_listener(a,"change","tiptap_embed_caption",i))};r(),c&&c.disconnect(),c=new MutationObserver(r),c.observe(e,{childList:!0,subtree:!0,attributes:!1,characterData:!1})}({app:t})))}const p=()=>{const t=t=>t.indexOf("youtube.com")>-1,e=t=>t.indexOf("vimeo.com")>-1;return o.Node.create({name:"embed",addOptions:()=>({HTMLAttributes:{}}),group:"block",allowGapCursor:!1,draggable:!1,isolating:!0,selectable:!1,addAttributes:()=>({src:{default:null},title:{default:null}}),parseHTML:()=>[{tag:'iframe[src*="youtube.com"]',getAttrs:r=>(t(r.getAttribute("src"))||e(r.getAttribute("src"))>-1)&&null}],renderHTML({HTMLAttributes:r}){const n={width:"560",height:"315",allowfullscreen:"",frameborder:"0"},a={width:"640",height:"360",allowfullscreen:"",frameborder:"0"};let i;if(t(r.src)){i={...r,...n};const t=i.src.match(/watch.*v\=(?<vid>[^&]*)/)?.groups?.vid;t&&(i.src=`https://www.youtube.com/embed/${t}`)}if(e(r.src)){i={...r,...a};const t=i.src.match(/vimeo.com\/(?<vid>[0-9]*)/)?.groups?.vid;t&&(i.src=`https://player.vimeo.com/video/${t}`)}return["iframe",(0,o.mergeAttributes)(this.options.HTMLAttributes,i)]},addCommands(){return{setEmbed:t=>({commands:e})=>e.insertContent({type:this.name,attrs:t})}},addProseMirrorPlugins(){return[new i.Sy({props:{handleDOMEvents:{dragstart:(t,e)=>{if(!e.target)return!1;const r=t.posAtDOM(e.target,0);return t.state.doc.resolve(r).parent.type===this.type&&e.preventDefault(),!1}}}})]}})}},37236:function(t,e,r){r.r(e),r.d(e,{TARGETS:function(){return o},focus_handler:function(){return i}});var n=r(52896),a=r(19513);const o=[];function i(t){t.setAttribute("tabindex","-1"),n.Z.add_event_listener(t,"focus","tiptap-focusin",(async()=>{a.Z.timeout(1),o.map((t=>t?.classList.add("tiptap-focus")))}),!0),n.Z.add_event_listener(t,"blur","tiptap-focusout",(()=>{o.map((t=>t?.classList.remove("tiptap-focus")))}),!0)}}}]);
//# sourceMappingURL=9280.72084bfe6cf0312c4780.min.js.map