"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[276],{5484:function(e,n,t){t.d(n,{s:function(){return l}});var s=t(8735),i=t(184);function l(e){switch(e.status){case"passed":return(0,i.jsx)(s.xv,{as:"span",role:"img",children:"\u2705"});case"failed":return(0,i.jsx)(s.xv,{as:"span",role:"img",children:"\u274c"});default:return(0,i.jsx)(s.xv,{as:"span",role:"img",children:"-"})}}},6646:function(e,n,t){t.d(n,{S:function(){return c}});var s=t(5987),i=t(7231),l=t(8735),r=t(9113),o=t(3853),d=t(184),a=["children","startingHeight","collapseable","onVisible"];function c(e){var n=e.children,t=e.startingHeight,c=void 0===t?250:t,u=e.collapseable,h=void 0===u||u,v=e.onVisible,x=(0,s.Z)(e,a);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(i.UO,{startingHeight:c,in:x.in,children:n}),h&&(0,d.jsxs)(l.kC,{as:"button",justifyContent:"center",alignItems:"center",color:"piperider.500",mt:4,height:8,onClick:function(){v()},children:[(0,d.jsx)(l.xv,{as:"span",children:x.in?"Less":"More"}),(0,d.jsx)(r.JO,{as:o.rH8,boxSize:6,transform:x.in?"rotate(0deg)":"rotate(180deg)",transition:"transform 0.2s ease-in"})]})]})}},4673:function(e,n,t){t.d(n,{m:function(){return v}});var s=t(8735),i=t(9113),l=t(7482),r=t(5960),o=t(4435),d=t(3853),a=t(6523),c=t(709),u=t(2740),h=t(184);function v(e){var n=e.baseTable,t=e.targetTable,v=e.singleOnly;(0,a.h5)(a.vT.safeParse(n)),(0,a.h5)(a.vT.safeParse(t));var x=n||t;return(0,h.jsxs)(s.rj,{mb:8,gap:6,templateColumns:v?"1fr 2fr":"1fr 1fr",children:[(0,h.jsxs)(s.P4,{gap:1,colSpan:2,children:[(0,h.jsx)(s.xv,{color:"gray.500",children:"Table"}),(0,h.jsx)(s.X6,{fontSize:24,children:(0,h.jsxs)(s.kC,{alignItems:"center",children:[(0,h.jsx)(i.JO,{as:d.aCJ,mr:1}),null===x||void 0===x?void 0:x.name]})})]}),(0,h.jsxs)(s.rj,{gap:2,children:[!v&&(0,h.jsx)(u.$,{name:"",firstSlot:"Base",firstSlotWidth:"16em",secondSlot:"Target",secondSlotWidth:"16em",width:"100%",fontWeight:"bold",mb:3}),(0,h.jsx)(u.$,{width:"100%",name:"Row Count",metakey:"row_count",firstSlot:(0,c.uf)(null===n||void 0===n?void 0:n.row_count),firstSlotWidth:"16em",secondSlot:(0,c.uf)(null===t||void 0===t?void 0:t.row_count),secondSlotWidth:"16em"}),(0,h.jsx)(u.$,{width:"100%",name:"Column Count",metakey:"col_count",firstSlot:(0,c.uf)(null===n||void 0===n?void 0:n.col_count),firstSlotWidth:"16em",secondSlot:(0,c.uf)(null===t||void 0===t?void 0:t.col_count),secondSlotWidth:"16em"}),(null===x||void 0===x?void 0:x.bytes)&&(0,h.jsx)(u.$,{width:"100%",name:"Volume Size",metakey:"bytes",firstSlot:(0,c.td)(null===n||void 0===n?void 0:n.bytes),firstSlotWidth:"16em",secondSlot:(0,c.td)(null===t||void 0===t?void 0:t.bytes),secondSlotWidth:"16em",tooltipValues:{firstSlot:"".concat((0,c.uf)(null===n||void 0===n?void 0:n.bytes)," bytes"),secondSlot:"".concat((0,c.uf)(null===t||void 0===t?void 0:t.bytes)," bytes")}}),(null===x||void 0===x?void 0:x.created)&&(0,h.jsx)(u.$,{width:"100%",name:"Created At",metakey:"created",firstSlot:(0,c.D8)(null===n||void 0===n?void 0:n.created),firstSlotWidth:"16em",secondSlot:(0,c.D8)(null===t||void 0===t?void 0:t.created),secondSlotWidth:"16em"}),(null===x||void 0===x?void 0:x.last_altered)&&(0,h.jsx)(u.$,{width:"100%",name:"Last Altered",metakey:"last_altered",firstSlot:(0,c.D8)(null===n||void 0===n?void 0:n.last_altered),firstSlotWidth:"16em",secondSlot:(0,c.D8)(null===t||void 0===t?void 0:t.last_altered),secondSlotWidth:"16em"}),(null===x||void 0===x?void 0:x.freshness)&&(0,h.jsx)(u.$,{width:"100%",name:"Freshness",metakey:"freshness",firstSlot:(0,l.Z)((0,r.Z)({start:(0,o.Z)(new Date,(null===n||void 0===n?void 0:n.freshness)||0),end:new Date})),firstSlotWidth:"16em",secondSlot:(0,l.Z)((0,r.Z)({start:(0,o.Z)(new Date,(null===t||void 0===t?void 0:t.freshness)||0),end:new Date})),secondSlotWidth:"16em"})]}),(0,h.jsx)(s.P4,{colSpan:1,mx:v?"10em":"5em",children:(0,h.jsx)(s.xv,{fontSize:"sm",border:"1px solid lightgray",p:2,h:"12em",overflow:"auto",children:null===x||void 0===x?void 0:x.description})})]})}},9276:function(e,n,t){t.r(n),t.d(n,{default:function(){return L}});var s=t(1413),i=t(2982),l=t(885),r=t(5223),o=t(8735),d=t(8625),a=t(2791),c=t(8062),u=t(6157),h=t(2483),v=t(5987),x=t(8540),j=t(2504),m=t(7005),f=t(5558),p=t(5484),b=t(184);function g(e){var n,t,s,i,l,r,o=e.data;return(0,b.jsx)(m.xJ,{children:(0,b.jsxs)(m.iA,{variant:"simple",children:[(0,b.jsx)(m.hr,{children:(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Th,{}),(0,b.jsx)(m.Th,{children:"Status"}),(0,b.jsx)(m.Th,{children:"Message"})]})}),(0,b.jsxs)(m.p3,{children:[(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{fontWeight:700,children:"Base"}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(p.s,{status:null===o||void 0===o||null===(n=o.base)||void 0===n?void 0:n.status})}),(0,b.jsx)(m.Td,{children:null!==(t=null===o||void 0===o||null===(s=o.base)||void 0===s?void 0:s.message)&&void 0!==t?t:f.Nj})]}),(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{fontWeight:700,children:"Target"}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(p.s,{status:null===o||void 0===o||null===(i=o.target)||void 0===i?void 0:i.status})}),(0,b.jsx)(m.Td,{children:null!==(l=null===o||void 0===o||null===(r=o.base)||void 0===r?void 0:r.message)&&void 0!==l?l:f.Nj})]})]})]})})}var T=t(709);function S(e){var n,t,s,i,l,r,o=e.data;return(0,b.jsx)(m.xJ,{children:(0,b.jsxs)(m.iA,{variant:"simple",children:[(0,b.jsx)(m.hr,{children:(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Th,{}),(0,b.jsx)(m.Th,{children:"Status"}),(0,b.jsx)(m.Th,{children:"Expected"}),(0,b.jsx)(m.Th,{children:"Actual"})]})}),(0,b.jsxs)(m.p3,{children:[(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{fontWeight:700,children:"Base"}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(p.s,{status:null===o||void 0===o||null===(n=o.base)||void 0===n?void 0:n.status})}),(0,b.jsx)(m.Td,{children:(0,T.sG)(null===o||void 0===o||null===(t=o.base)||void 0===t?void 0:t.expected)}),(0,b.jsx)(m.Td,{children:(0,T.sG)(null===o||void 0===o||null===(s=o.base)||void 0===s?void 0:s.actual)})]}),(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{fontWeight:700,children:"Target"}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(p.s,{status:null===o||void 0===o||null===(i=o.target)||void 0===i?void 0:i.status})}),(0,b.jsx)(m.Td,{children:(0,T.sG)(null===o||void 0===o||null===(l=o.target)||void 0===l?void 0:l.expected)}),(0,b.jsx)(m.Td,{children:(0,T.sG)(null===o||void 0===o||null===(r=o.target)||void 0===r?void 0:r.actual)})]})]})]})})}var C=["data","type","isOpen","onClose"];function y(e){var n=e.data,t=e.type,i=void 0===t?"piperider":t,l=e.isOpen,r=e.onClose,d=(0,v.Z)(e,C);return(0,b.jsxs)(x.u_,(0,s.Z)((0,s.Z)({},d),{},{isOpen:l,size:"2xl",onClose:function(){r()},children:[(0,b.jsx)(x.ZA,{}),(0,b.jsxs)(x.hz,{children:[(0,b.jsx)(x.xB,{children:(0,b.jsx)(o.xv,{title:null===n||void 0===n?void 0:n.name,noOfLines:1,maxWidth:"calc(100% - 50px)",children:null===n||void 0===n?void 0:n.name})}),(0,b.jsx)(x.ol,{}),(0,b.jsx)(x.fe,{children:"piperider"===i?(0,b.jsx)(S,{data:n}):(0,b.jsx)(g,{data:n})}),(0,b.jsx)(x.mz,{children:(0,b.jsx)(j.zx,{onClick:r,children:"Close"})})]})]}))}var Z=t(6523),k=t(1241),w=t(429),W=t(3811),D=t(2915),_=t(2740),N=t(5676),A=t(2917),O=function(e){var n,t,s,i,l=e.baseColumn,r=e.targetColumn,d=e.singleOnly,a=e.onSelect,c=l||r,u=(0,w.JH)(l);return(0,Z.h5)(Z.a$.safeParse(l)),(0,Z.h5)(Z.a$.safeParse(r)),(0,b.jsxs)(o.kC,{direction:"column",minH:"250px",border:"1px solid darkgray",rounded:"2xl",children:[c&&(0,b.jsx)(D.u,{columnDatum:c,bg:"blue.800",color:"white"}),(0,b.jsxs)(o.xu,{m:4,children:[!d&&(0,b.jsx)(_.$,{name:"",firstSlot:"Base",secondSlot:"Target",width:"100%",fontWeight:"bold",mb:3}),(0,b.jsx)(o.xu,{mb:3,children:(0,b.jsx)(N.P,{baseColumnDatum:l,targetColumnDatum:r,singleOnly:d})}),(0,b.jsx)(o.xu,{mb:3,children:(0,b.jsx)(A.Y,{baseColumnDatum:l,targetColumnDatum:r,singleOnly:d})}),u&&(0,b.jsx)(o.xu,{children:(0,b.jsx)(_.$,{name:"Most Common",metakey:"topk",width:"100%",firstSlot:null!==(n=null===l||void 0===l||null===(t=l.topk)||void 0===t?void 0:t.values[0])&&void 0!==n?n:f.Nj,secondSlot:null!==(s=null===r||void 0===r||null===(i=r.topk)||void 0===i?void 0:i.values[0])&&void 0!==s?s:f.Nj})})]}),c&&(0,b.jsx)(o.kC,{justifyContent:"center",p:3,h:"100%",alignItems:"end",cursor:"pointer",onClick:function(){return a({columnName:c.name})},children:(0,b.jsx)(o.xv,{as:"a",color:"blue.400",children:"Details"})})]})};function P(e){var n=e.baseTable,t=e.targetTable,s=e.onSelect;(0,Z.h5)(Z.vT.safeParse(n)),(0,Z.h5)(Z.vT.safeParse(t));var i=(0,w.WN)(null===n||void 0===n?void 0:n.columns,null===t||void 0===t?void 0:t.columns),r=(null===n||void 0===n?void 0:n.name)||(null===t||void 0===t?void 0:t.name);return(0,b.jsx)(b.Fragment,{children:Object.entries(i).map((function(e){var n=(0,l.Z)(e,2),t=n[0],i=n[1],d=i.base,a=i.target;return(0,b.jsx)(o.kC,{direction:"column",children:(0,b.jsxs)(o.rj,{my:8,templateColumns:"1fr 2fr",gap:12,overflowX:"hidden",children:[(0,b.jsx)(O,{baseColumn:d,targetColumn:a,onSelect:function(e){var n=e.columnName;return s({columnName:n,tableName:r})}}),(0,b.jsxs)(o.kC,{my:4,alignItems:"center",children:[(0,b.jsx)(W.B,{height:350,children:(0,k.S)(d)}),(0,b.jsx)(W.B,{height:350,children:(0,k.S)(a,d)})]})]})},t)}))})}var $=t(4673),z=t(6646),H=t(8444),R=t.n(H),V=t(5984),B=["assertions"];function J(e){return Object.values(e).map((function(e){var n={name:e[0].name};return e.forEach((function(e){"base"===e.from?n.base=e:n.target=e})),n}))}function I(e){var n=e.assertions,t=(0,v.Z)(e,B),s=n.piperider,l=n.dbt,r=R()(s,(function(e){return"".concat(e.level,"_").concat(e.column,"_").concat(e.name)})),d=R()(l,(function(e){return"".concat(e.level,"_").concat(e.column,"_").concat(e.name)})),a=J(r),c=J(d),u=function(e,n){var t=e.reduce((function(e,n){return G("PipeRider",n,e)}),{passed:[],failed:[]}),s=t.passed,l=t.failed,r=n.reduce((function(e,n){return G("dbt",n,e)}),{passed:[],failed:[]}),o=r.passed,d=r.failed;return{passedAssertionRows:[].concat((0,i.Z)(s),(0,i.Z)(o)),failedAssertionRows:[].concat((0,i.Z)(l),(0,i.Z)(d))}}(a,c),h=u.passedAssertionRows,x=u.failedAssertionRows;return 0===a.length&&0===c.length?(0,b.jsx)(o.kC,{direction:"column",justifyContent:"center",alignItems:"center",children:(0,b.jsx)(o.xv,{textAlign:"center",children:"No tests available"})}):(0,b.jsx)(m.xJ,{children:(0,b.jsxs)(m.iA,{variant:"simple",children:[(0,b.jsx)(m.hr,{children:(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Th,{children:"Assertion"}),(0,b.jsx)(m.Th,{children:"Base Status"}),(0,b.jsx)(m.Th,{children:"Target Status"}),(0,b.jsx)(m.Th,{children:"Source"}),(0,b.jsx)(m.Th,{})]})}),(0,b.jsxs)(m.p3,{children:[x.map((function(e){var n,s;return(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{children:e.name}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(p.s,{status:null===(n=e.base)||void 0===n?void 0:n.status})}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(p.s,{status:null===(s=e.target)||void 0===s?void 0:s.status})}),(0,b.jsx)(m.Td,{children:e.source}),(0,b.jsx)(m.Td,{onClick:function(){t.onDetailVisible({type:"piperider",data:e})},children:(0,b.jsx)(o.xv,{as:"span",cursor:"pointer",children:"\ud83d\udd0d"})})]},(0,V.x0)())})),h.map((function(e){var n,s;return(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{children:e.name}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(p.s,{status:null===(n=e.base)||void 0===n?void 0:n.status})}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(p.s,{status:null===(s=e.target)||void 0===s?void 0:s.status})}),(0,b.jsx)(m.Td,{children:e.source}),(0,b.jsx)(m.Td,{onClick:function(){t.onDetailVisible({type:"piperider",data:e})},children:(0,b.jsx)(o.xv,{as:"span",cursor:"pointer",children:"\ud83d\udd0d"})})]},(0,V.x0)())}))]})]})})}function G(e,n,t){var i,l;n&&("failed"===(null===(i=n.base)||void 0===i?void 0:i.status)||"failed"===(null===(l=n.target)||void 0===l?void 0:l.status)?t.failed.push((0,s.Z)((0,s.Z)({},n),{},{source:e})):t.passed.push((0,s.Z)((0,s.Z)({},n),{},{source:e})));return t}var M=t(4002),X=t(5761),F=t(6499);function L(e){var n=e.data,t=e.tableName,v=(0,a.useState)(null),x=(0,l.Z)(v,2),j=x[0],m=x[1],f=(0,r.qY)(),p=(0,a.useState)(!1),g=(0,l.Z)(p,2),S=g[0],C=g[1],k=(0,a.useState)(!1),w=(0,l.Z)(k,2),W=w[0],D=w[1],_=(0,d.TH)(),N=(0,l.Z)(_,2)[1];if((0,h.j)(t),!n||!t)return(0,b.jsx)(c.o,{isSingleReport:!0,time:"-",children:(0,b.jsx)(F.J,{text:"No profile data found."})});var A=n.base,O=n.input;(0,Z.h5)((0,Z.C6)(!0).safeParse(n));var H=A.tables[t],R=O.tables[t];(0,Z.h5)(Z.vT.safeParse(H)),(0,Z.h5)(Z.vT.safeParse(R));var V=(0,u.Ix)({data:n,tableName:t,type:"piperider"}),B=(0,l.Z)(V,2),J=B[0],G=B[1],L=(0,u.Ix)({data:n,tableName:t,type:"dbt"}),E=(0,l.Z)(L,2),Y=E[0],q=E[1],Q=[].concat((0,i.Z)((null===J||void 0===J?void 0:J.tests)||[]),(0,i.Z)((null===G||void 0===G?void 0:G.tests)||[])),U=[].concat((0,i.Z)((null===Y||void 0===Y?void 0:Y.tests)||[]),(0,i.Z)((null===q||void 0===q?void 0:q.tests)||[])),K=0===Q.length&&0===U.length;return(0,b.jsxs)(c.o,{isSingleReport:!1,time:"".concat((0,T.D8)(A.created_at)," -> ").concat((0,T.D8)(O.created_at)),children:[(0,b.jsxs)(o.kC,{direction:"column",width:"inherit",children:[(0,b.jsx)(M.Q,{routePathToMatch:X.W}),(0,b.jsxs)(o.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"5%",direction:"column",children:[(0,b.jsx)($.m,{baseTable:H,targetTable:R}),(0,b.jsx)(o.X6,{size:"md",children:"Assertions"}),(0,b.jsx)(z.S,{in:S,startingHeight:K?50:250,collapseable:!K,onVisible:function(){return C((function(e){return!e}))},children:(0,b.jsx)(I,{assertions:{piperider:Q,dbt:U},onDetailVisible:function(e){var n=e.data,t=e.type;m({type:t,data:n}),f.onOpen()}})}),(0,b.jsx)(o.X6,{size:"md",mt:4,children:"Columns"}),(0,b.jsx)(z.S,{in:W,startingHeight:void 0===H&&void 0===R?50:350,collapseable:void 0!==H||void 0!==R,onVisible:function(){return D((function(e){return!e}))},children:(0,b.jsx)(P,{baseTable:H,targetTable:R,onSelect:function(e){var n=e.tableName,t=e.columnName;return N("/tables/".concat(n,"/columns/").concat(t))}})})]})]}),(0,b.jsx)(y,(0,s.Z)((0,s.Z)({},f),{},{type:null===j||void 0===j?void 0:j.type,data:null===j||void 0===j?void 0:j.data,onClose:function(){f.onClose(),m(null)}}))]})}}}]);
//# sourceMappingURL=276.fcb4db01.chunk.js.map